# --
# Copyright (C) 2001-2017 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

<div class="LayoutPopup ARIARoleMain">

    <div class="Header">
        <h1>
            [% Translate("Attachments of") | html %] [% Config("Ticket::Hook") %]: [% Data.TicketNumber | html %] - [% Data.Title | html %]
        </h1>
        <p>
            <a href="#" class="CancelClosePopup">[% Translate("Close") | html %]</a>
        </p>
    </div>

    <div class="Content">
        <div class="WidgetSimple">
            <div class="Header">
                <h2>
                    [% Translate("Attachment Overview") | html %]
                </h2>
            </div>
            <div class="Content">
[% RenderBlockStart("NoAttachments") %]
                <p>[% Translate("This ticket does not have any attachments.") | html %]</p>
[% RenderBlockEnd("NoAttachments") %]
[% RenderBlockStart("HasAttachments") %]
                <iframe src="about:blank" width="0" height="0" name="AttachmentWindow" id="AttachmentWindow" class="Hidden"></iframe>
[% RenderBlockStart("TableHeader") %]
                <form action="[% Env("CGIHandle") %]" method="post" enctype="multipart/form-data" name="compose" id="Compose" class="PreventMultipleSubmits">
                    <input type="hidden" name="Action" value="[% Env("Action") %]"/>
                    <input type="hidden" name="Subaction" value="DownloadAttachments"/>
                    <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]"/>

                    <div class="FloatRight">
                        <label for="InlineHide">[% Translate("Hide inline attachments") | html %]</label>
                        <input type="checkbox" id="InlineHide" [% Data.InlineHide %]/>
                    </div>

                    <input type="text" id="FilterAttachments" class="W50pc" name="FilterAttachments" value="" title="[% Translate("Filter Attachments") | html %]" placeholder="[% Translate("Filter Attachments") | html %]..." />

                    <table class="DataTable" id="AttachmentTable">
                        <thead>
                            <tr>
                                <th class="Checkbox"><input type="checkbox" name="Checkbox" title="[% Translate("Select All") | html %]" id="SelectAll" value="" /></th>
                                <th class="Filetype Sortable"><a href="#">[% Translate("Type") | html %]</a></th>
                                <th class="Filename Sortable"><a href="#">[% Translate("Filename") | html %]</a></th>
                                <th class="Filesize Sortable"><a href="#">[% Translate("Size") | html %]</a></th>
                                <th class="Date Sortable InitialSorting Descending"><a href="#">[% Translate("Date") | html %]</a></th>
                                <th class="Direction Sortable"><a href="#" title="[% Translate("Direction") | html %]"><i class="fa fa-exchange"></i></a></th>
                                <th class="ArticleName Sortable"><a href="#">[% Translate("Article") | html %]</a></th>
                            </tr>
                        </thead>
                        <tbody>
[% RenderBlockEnd("TableHeader") %]
[% RenderBlockStart("TableRow") %]
                            <tr class="[% Data.InlineAttachment | html %]">
                                <td class="Checkbox"><input type="checkbox" name="Checkbox" value="Checkbox[% Data.ArticleID %]_[% Data.FileID %]" title="[% Translate("Select") | html %]" id="Checkbox[% Data.ArticleID %]_[% Data.FileID %]" /></td>
                                <td class="Filetype">
                                    <i class="fa [% Data.ContentTypeCss | html %]" title="[% Data.ContentType | html %]"></i>
                                    <input type="hidden" class="SortData" value="[% Data.ContentTypeCss %]" />
                                </td>
                                <td class="Filename">
                                    <a href="[% Env("Baselink") %]Action=AgentTicketAttachment;ArticleID=[% Data.ArticleID | uri %];FileID=[% Data.FileID | uri %]" [% Data.Target %] title="[% Translate("Click to download this file") | html %]">[% Data.Filename | html %]</a>
                                    <input type="hidden" class="SortData" value="[% Data.Filename %]" />
                                </td>
                                <td class="Filesize">
                                    [% Data.Filesize | html %]
                                    <input type="hidden" class="SortData" value="[% Data.FilesizeRaw %]" />
                                </td>
                                <td class="Date">
                                    [% Data.Created | Localize("TimeShort") %]
                                    <input type="hidden" class="SortData" value="[% Data.Created | html %]" />
                                </td>
                                <td class="Direction">
                                    <span class="Direction [% Data.CommunicationDirection | html %]" title="[% Translate(Data.CommunicationDirection _ " message") | html %]">
                                        <i class="fa fa-square-o"></i>
                                    [% IF Data.CommunicationDirection == "Incoming" %]
                                        <i class="fa fa-long-arrow-left"></i>
                                        [% DirectionSortValue = 0 %]
                                    [% ELSIF Data.CommunicationDirection == "Outgoing" %]
                                        <i class="fa fa-long-arrow-right"></i>
                                        [% DirectionSortValue = 1 %]
                                    [% ELSIF Data.CommunicationDirection == "Internal" %]
                                        [% DirectionSortValue = 2 %]
                                    [% END %]
                                    </span>
                                    <input type="hidden" class="SortData" value="[% DirectionSortValue %]" />
                                </td>
                                <td class="ArticleName">
                                    <a href="[% Env("CGIHandle") %]?Action=AgentTicketZoom;TicketID=[% Data.TicketID | html %];ArticlePage=[% Data.ArticlePage | html %]#[% Data.ArticleID | html %]" data-articleid="[% Data.ArticleID | html %]" data-articlepage="[% Data.ArticlePage | html %]" title="[% Translate("Open article in main window") | html %]">#[% Data.Count | html %] - [% Data.Subject | truncate(36) | html %]</a>
                                    <input type="hidden" class="SortData" value="[% Data.Subject | html %]" />
                                </td>
                            </tr>
[% RenderBlockEnd("TableRow") %]
[% RenderBlockStart("TableFooter") %]
                            <tr class="FilterMessage Hidden">
                                <td colspan="7">[% Translate("No matches found.") | html %]</td>
                            </tr>
                        </tbody>
                    </table>
[% RenderBlockEnd("TableFooter") %]
                    <button class="CallForAction Hidden" id="DownloadArchive" title="[% Translate("Download selected files as archive") | html %]" type="submit" value="[% Translate("Download selected files as archive") | html %]"><span><i class="fa fa-download"></i> [% Translate("Download selected files as archive") | html %]</span></button>
                </form>
[% RenderBlockEnd("HasAttachments") %]
            </div>
        </div>
    </div>
    <div class="Footer">
        <button class="CallForAction Primary" id="CloseWindow" accesskey="g" title="[% Translate("Close") | html %] (g)" type="submit" value="[% Translate("Close") | html %]"><span><i class="fa fa-check-square-o"></i> [% Translate("Close") | html %]</span></button>
    </div>
</div>
[% WRAPPER JSOnDocumentComplete %]
<script type="text/javascript">//<![CDATA[
Core.Agent.TicketAttachmentView.Init();
//]]></script>
[% END %]
